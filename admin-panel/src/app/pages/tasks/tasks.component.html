<table mat-table [dataSource]="tasks" class="mat-elevation-z8">

  <!-- ID Column -->
  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef> ID </th>
    <td mat-cell *matCellDef="let task"> {{ task.id }} </td>
  </ng-container>

  <!-- Title Column -->
  <ng-container matColumnDef="title">
    <th mat-header-cell *matHeaderCellDef> –ù–∞–∑–≤–∞–Ω–∏–µ </th>
    <td mat-cell *matCellDef="let task"> {{ task.title }} </td>
  </ng-container>

  <!-- Creator Column -->
  <ng-container matColumnDef="creator">
    <th mat-header-cell *matHeaderCellDef> –ó–∞–∫–∞–∑—á–∏–∫ </th>
    <td mat-cell *matCellDef="let task"> {{ task.creator.name }} </td>
  </ng-container>

  <!-- Executor Column -->
  <ng-container matColumnDef="executor">
    <th mat-header-cell *matHeaderCellDef> –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å </th>
    <td mat-cell *matCellDef="let task"> {{ task.executor?.name || 'Not Assigned' }} </td>
  </ng-container>

  <!-- Description Column -->
  <ng-container matColumnDef="description">
    <th mat-header-cell *matHeaderCellDef> –û–ø–∏—Å–∞–Ω–∏–µ </th>
    <td mat-cell *matCellDef="let task"> {{ task.description }} </td>
  </ng-container>

  <!-- Location Column -->
  <ng-container matColumnDef="location">
    <th mat-header-cell *matHeaderCellDef> –ú–µ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è </th>
    <td mat-cell *matCellDef="let task"> {{ task.location }} </td>
  </ng-container>

  <!-- Payment Column -->
  <ng-container matColumnDef="payment">
    <th mat-header-cell *matHeaderCellDef> –û–ø–ª–∞—Ç–∞ </th>
    <td mat-cell *matCellDef="let task"> {{ task.payment }} </td>
  </ng-container>

  <!-- Options Column -->
  <ng-container matColumnDef="options">
    <th mat-header-cell *matHeaderCellDef> –û–ø—Ü–∏–∏ </th>
    <td mat-cell *matCellDef="let task">
        @if(task.pack_needed) {
            <div class="option">
                üì¶ –£–ø–∞–∫–æ–≤–∫–∞: {{ task.pack_description || '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}
            </div>
        }
        @if(task.tool_needed) {
          <div class="option">
            üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: {{ task.tool_description || '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}
          </div>
        }
        @if(task.assemble_needed) {
          <div class="option">
            üîß –°–±–æ—Ä–∫–∞: {{ task.assemble_description || '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}
          </div>
        }
        @if(!task.pack_needed && !task.tool_needed && !task.assemble_needed) {
          <div>
            –ù–µ—Ç –æ–ø—Ü–∏–π
          </div>
        }
    </td>
  </ng-container>

  <!-- Status Column -->
  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef> –°—Ç–∞—Ç—É—Å </th>
    <td mat-cell *matCellDef="let task"> {{ task.status }} </td>
  </ng-container>

  <!-- Status Column -->
  <ng-container matColumnDef="photo">
    <th mat-header-cell *matHeaderCellDef> –§–æ—Ç–æ </th>
    <td mat-cell *matCellDef="let task"> 
        <div>
            <button mat-button color="primary" (click)="openPhotoDialog(task.id)">–§–æ—Ç–æ</button>
        </div>
    </td>
  </ng-container>

  <!-- Actions Column -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>  </th>
    <td mat-cell *matCellDef="let task">
        @if(task.status === '–Ω–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏' || task.status === 'pending' ){
            <div>
                <button mat-button color="primary" (click)="approveTask(task.id)">–£—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        } 
        @if(task.status === '—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' || task.status === 'approved' ){
            <div>
                <button mat-button color="primary" (click)="cancelApproveTask(task.id)">–û—Ç–º–µ–Ω–∏—Ç—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</button>
            </div>
        } 
        <div>
            <button mat-button color="accent">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>
